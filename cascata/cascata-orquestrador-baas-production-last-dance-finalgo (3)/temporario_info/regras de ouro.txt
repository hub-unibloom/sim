üõ°Ô∏è CASCATA SECURITY PROTOCOL (AUTO-PROMPT)
A Regra Suprema (Security First + Zero Regression):

Contexto: Voc√™ est√° atuando no n√∫cleo do Cascata, um BaaS Multi-tenant Open Source.
O sistema opera em dois planos: Control Plane (Admin do Sistema) e Data Plane (Dados dos Tenants).
A Regra Suprema (Security First + Zero Regression):
Ao corrigir uma vulnerabilidade, voc√™ N√ÉO PODE quebrar a funcionalidade existente, nem introduzir novas falhas l√≥gicas de nenhum tipo!
O intuito da corre√ß√£o √© upgrade com zero regress√£o.


Se voc√™ tocar em um arquivo, devolva-o *completo e corrigido*. Se a corre√ß√£o exigir alterar a l√≥gica de neg√≥cio (ex: mudar o fluxo de Link Identity), explique o motivo de seguran√ßa (ex: "Preven√ß√£o de Sequestro de Conta").



Pontos chave:
Contexto do Tenant
Input Hostil
Recursos Finitos
Seguran√ßa em Profundidade

NUNCA JAMAIS EDITE UM ARQUIVO SEM ME DIZER O PORQUE E EU DAR A PERMISS√ÉO ANTES.

REGRAS FUNDAMENTAIS DO SISTEMA (OBRIGAT√ìRIAS)
Regra n¬∫ 1 ‚Äî Fundamental (absoluta)
Respeitar integralmente a nomenclatura dos arquivos e todas as refer√™ncias a eles.
Nenhum arquivo pode ser renomeado, movido ou referenciado de forma diferente.
Essa regra n√£o admite exce√ß√µes, em nenhuma altera√ß√£o.
Regra n¬∫ 2 ‚Äî Preserva√ß√£o do que j√° funciona
Ao adicionar, ajustar ou melhorar qualquer coisa (rota, tabela, servi√ßo ou funcionalidade):
‚ùå √â proibido remover, quebrar ou regredir partes essenciais j√° funcionais.
‚úÖ Se algo estiver fora do novo padr√£o, deve ser atualizado ou migrado, nunca eliminado.
A evolu√ß√£o do sistema n√£o pode reduzir:
completude
estabilidade
capacidade funcional
Tudo que j√° existia deve continuar existindo no mesmo n√≠vel ou melhor.
üìÅ REGRA DE ARQUIVOS SENS√çVEIS (PLATAFORMA)
Arquivos sens√≠veis N√ÉO devem ser criados com o nome final real.
Eles DEVEM ser escritos com .txt no final.
Forma correta de cria√ß√£o
.env.txt
nginx/nginx.conf.txt
database/init.sql.txt
backend/Dockerfile.txt
frontend/Dockerfile.txt
frontend/nginx.conf.txt
‚ö†Ô∏è Motivo: o ambiente (Studio / app.new) buga esses arquivos.
O sistema final ser√° enviado ao GitHub e aplicado manualmente em VPS.
Aplica√ß√£o real no servidor
Ap√≥s baixar o projeto:
mv .env.txt .env
mv nginx/nginx.conf.txt nginx/nginx.conf
mv database/init.sql.txt database/init.sql
mv backend/Dockerfile.txt backend/Dockerfile
mv frontend/Dockerfile.txt frontend/Dockerfile
mv frontend/nginx.conf.txt frontend/nginx.conf
docker compose up -d --build
üß† REGRA N√çVEL MESTRE ‚Äî server.ts
ABSOLUTA
Sempre que editar, corrigir ou adicionar algo em server.ts:
‚ùå PROIBIDO remover partes existentes para ‚Äúsimplificar‚Äù
‚ùå PROIBIDO entregar vers√µes parciais
‚úÖ OBRIGAT√ìRIO reescrever o arquivo inteiro, mantendo:
todas as rotas
todas as fun√ß√µes
todas as integra√ß√µes existentes
Exemplo pr√°tico
O server.ts tem 1.800+ linhas
Voc√™ precisa corrigir ou adicionar algo.
‚û°Ô∏è Voc√™ deve devolver o arquivo completo, com:
o novo padr√£o aplicado
o erro corrigido
todas as funcionalidades antigas preservadas ou atualizadas e n√£o simplesmente excluir.
Nunca excluir conte√∫do para ganhar velocidade.



NUNCA JAMAIS EDITE UM ARQUIVO SEM ME DIZER O PORQUE E EU DAR A PERMISS√ÉO ANTES.